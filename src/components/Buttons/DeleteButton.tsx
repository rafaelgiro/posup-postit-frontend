import { useContext } from "react";

import { NotesContext } from "../../contexts/NotesContext";
import { api } from "../../utils/api";

import { ButtonProps } from "./interfaces";
import { ActionButton } from "./styles";

export const DeleteButton = (props: ButtonProps) => {
  const { id } = props;
  const { setNotes } = useContext(NotesContext);

  async function handleDelete() {
    try {
      await api.delete(`/postits/${id}`);
      setNotes((currNotes) => {
        const newNotes = [...currNotes];
        const index = newNotes.findIndex((n) => n._id === id);
        newNotes.splice(index, 1);
        return newNotes;
      });
    } catch (error) {
      console.error(error);
    }
  }

  return (
    <ActionButton onClick={handleDelete}>
      <svg
        width="30"
        height="30"
        viewBox="0 0 61 61"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M17.4795 1.70011L43.7795 1.36011L54.8595 7.32011L60.8595 15.7201L54.5195 43.9001L51.9195 56.3801L45.8195 57.3401L15.6995 56.5801L3.75953 53.4401L0.519531 45.5801L5.67953 8.12011L9.87953 6.66011L20.5595 6.90011"
          fill="#F44336"
        />
        <path
          d="M3.9992 17.5002C3.2192 12.8802 8.9592 3.94022 17.4992 4.00022M17.4992 4.00022C29.4392 3.54022 35.7392 4.90022 44.5192 4.00022H17.4992ZM17.4992 4.00022C23.9792 2.86022 30.3592 4.40022 44.5192 4.00022H17.4992ZM44.5192 4.00022C57.1792 7.70022 59.7992 8.84022 58.0192 17.5002L44.5192 4.00022ZM44.5192 4.00022C56.6392 6.60022 56.1592 11.4202 58.0192 17.5002L44.5192 4.00022ZM58.0192 17.5002C59.2392 25.0402 58.4592 30.8202 58.0192 44.5202V17.5002ZM58.0192 17.5002C57.6192 26.3402 57.4992 37.6202 58.0192 44.5202V17.5002ZM58.0192 44.5202C60.0392 50.2402 55.1392 59.2602 44.5192 58.0202L58.0192 44.5202ZM58.0192 44.5202C57.7992 55.8602 54.9392 57.2802 44.5192 58.0202L58.0192 44.5202ZM44.5192 58.0202C36.3592 60.6002 22.4992 55.9802 17.4992 58.0202H44.5192ZM44.5192 58.0202C34.7592 57.1802 27.7992 59.3802 17.4992 58.0202H44.5192ZM17.4992 58.0202C11.0192 57.7402 7.2592 50.8402 3.9992 44.5202L17.4992 58.0202ZM17.4992 58.0202C7.0392 56.9802 4.8992 53.6002 3.9992 44.5202L17.4992 58.0202ZM3.9992 44.5202C1.3392 35.7602 6.1992 28.2002 3.9992 17.5002V44.5202ZM3.9992 44.5202C4.0592 37.4602 2.7192 28.5602 3.9992 17.5002V44.5202ZM3.9992 17.5002C4.3192 9.42022 5.5792 1.96022 17.4992 4.00022L3.9992 17.5002Z"
          stroke="#F44336"
          strokeWidth="4"
          strokeLinecap="round"
        />
        <path
          d="M20.337 18.1763C20.477 27.2763 20.597 36.3963 20.737 44.5163M18.917 43.3963C24.117 43.7363 29.317 44.0763 39.817 44.7563L18.917 43.3963ZM18.917 43.3963C25.577 43.8363 32.217 44.2763 39.817 44.7563L18.917 43.3963ZM39.817 44.7563C40.057 36.9363 40.297 29.0963 40.557 20.4163L39.817 44.7563ZM39.817 44.7563C40.077 35.8163 40.357 26.8763 40.557 20.4163L39.817 44.7563ZM40.557 20.4163C36.277 19.9363 31.997 19.4763 20.337 18.1763L40.557 20.4163ZM40.557 20.4163C34.197 19.7163 27.837 18.9963 20.337 18.1763L40.557 20.4163ZM20.337 18.1763C20.457 26.3763 20.577 34.5563 20.737 44.5163L20.337 18.1763Z"
          stroke="white"
          strokeWidth="2"
          strokeLinecap="round"
        />
        <path
          d="M14.3594 18.5383C25.4194 19.1383 36.4994 19.7583 45.1594 20.2383M14.3594 18.5383C20.7594 18.8983 27.1794 19.2383 45.1594 20.2383L14.3594 18.5383Z"
          stroke="white"
          strokeWidth="2"
          strokeLinecap="round"
        />
        <path
          d="M27.4926 20.5525C27.0926 26.2525 26.7126 31.9325 26.3926 36.6525M27.4926 20.5525C27.0926 26.3725 26.6926 32.1925 26.3926 36.6525L27.4926 20.5525Z"
          stroke="white"
          strokeWidth="2"
          strokeLinecap="round"
        />
      </svg>
    </ActionButton>
  );
};
